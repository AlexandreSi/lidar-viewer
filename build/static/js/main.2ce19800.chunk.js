(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{100:function(e,t,n){},178:function(e,t,n){},181:function(e,t,n){"use strict";n.r(t);var o=n(0),r=n.n(o),i=n(6),a=n.n(i),s=(n(100),n(102),n(92)),c=n(36),u=n(37),f=n(40),l=n(38),d=n(41),h=n(42),p=(n(115),n(28)),w=(n(118),n(5)),m=n(26),g=n(27);function v(){var e=Object(m.a)(["\n  display: flex;\n  flex-direction: column;\n  position: absolute;\n  width: 80%;\n  top: 50px;\n"]);return v=function(){return e},e}var y=g.a.div(v()),b=function(e){var t=e.colorsLoaded?2:e.fileRead?1:0;return r.a.createElement(y,null,r.a.createElement(p.a,{current:t},r.a.createElement(p.a.Step,{title:"Reading .LAS file",icon:0===t?r.a.createElement(w.a,{type:"loading"}):r.a.createElement(w.a,{type:"file-add"})}),r.a.createElement(p.a.Step,{title:"Loading colors",icon:1===t?r.a.createElement(w.a,{type:"loading"}):r.a.createElement(w.a,{type:"bg-colors"})}),r.a.createElement(p.a.Step,{title:"Ready to explore",icon:2===t?r.a.createElement(w.a,{type:"unlock"}):r.a.createElement(w.a,{type:"lock"})})))},S=n(62);function E(){var e=Object(m.a)(["\n  display: flex;\n  flex-wrap: wrap;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n"]);return E=function(){return e},e}function O(){var e=Object(m.a)(["\n  color: ",";\n  font-size: 40px;\n  font-family: ",";\n  margin-bottom: 30px;\n"]);return O=function(){return e},e}var x=g.a.div(O(),S.style["@primary-color"],S.style.fonts.primary),k=g.a.div(E()),C=n(2),z=function(e){var t=this;e.rotation.set(0,0,0);var n=new C.f;n.add(e);var o=new C.f;o.position.y=10,o.add(n);var r=Math.PI/2,i=function(e){if(!1!==t.enabled){var i=e.movementX||e.mozMovementX||e.webkitMovementX||0,a=e.movementY||e.mozMovementY||e.webkitMovementY||0;o.rotation.y-=.002*i,n.rotation.x-=.002*a,n.rotation.x=Math.max(-r,Math.min(r,n.rotation.x))}};this.dispose=function(){document.removeEventListener("mousemove",i,!1)},document.addEventListener("mousemove",i,!1),this.enabled=!1,this.getObject=function(){return o},this.getDirection=function(){var e=new C.k(0,0,-1),t=new C.c(0,0,0,"YXZ");return function(r){return t.set(n.rotation.x,o.rotation.y,0),r.copy(e).applyEuler(t),r}}()},L=function(e){var t={width:e.width,height:e.height},n=new C.j,o=function(e,t){var n=e.width,o=e.height,r=window.devicePixelRatio||1,i=new C.m({canvas:t,alpha:!0,antialias:!0});return i.setPixelRatio(r),i.setSize(n,o),i}(t,e),r=function(e){var t=e.width,n=e.height;return new C.g(75,t/n,1,1e3)}(t),i=function(e){var t=new z(e);return t.enabled=!0,function(e){e.position.set(50.53,4.88,4.33),e.rotation.y=-3.36}(t.getObject()),t}(r);n.add(i.getObject());var a=!1,s=!1,c=!1,u=!1,f=performance.now(),l=new C.k,d=new C.k;function h(e){e.keyCode in[38,90,37,81,40,83,39,68]&&(e.preventDefault(),e.stopPropagation())}return{update:function(){var e=performance.now(),t=(e-f)/1e3;l.x-=10*l.x*t,l.z-=10*l.z*t,d.z=Number(a)-Number(c),d.x=Number(s)-Number(u),d.normalize(),(a||c)&&(l.z-=50*d.z*t),(s||u)&&(l.x-=50*d.x*t),i.getObject().translateX(l.x*t),i.getObject().translateY(l.y*t),i.getObject().translateZ(l.z*t),f=e,o.render(n,r)},onKeyDown:function(e){switch(h(e),e.keyCode){case 38:case 90:a=!0;break;case 37:case 81:s=!0;break;case 40:case 83:c=!0;break;case 39:case 68:u=!0}},onKeyUp:function(e){switch(h(e),e.keyCode){case 38:case 90:a=!1;break;case 37:case 81:s=!1;break;case 40:case 83:c=!1;break;case 39:case 68:u=!1}},onWindowResize:function(e){var n=e.width,i=e.height;r.aspect=n/i,r.updateProjectionMatrix(),t.width=n,t.height=i,o.setSize(window.innerWidth,window.innerHeight)},createSceneSubjects:function(e,t){var n=t.position,o=t.color,r=new C.a;r.addAttribute("position",new C.e(n,3)),r.addAttribute("color",new C.e(o,3)),r.computeBoundingSphere();var i=new C.i({size:.1,vertexColors:C.l}),a=new C.h(r,i);a.name="pointCloud",e.add(a)},scene:n}},P=n(63),j=n.n(P),A=n(91),U=n(64),M=function(){this.manager=C.b,this.littleEndian=!0};M.prototype={constructor:M,load:function(e,t,n,o,r){var i=this,a=new C.d(i.manager);a.setResponseType("arraybuffer"),a.load(e,function(n){try{t(i.parse(n,e),r)}catch(a){if(!o)throw a;o(a)}},n,o)},parse:function(){var e=Object(A.a)(j.a.mark(function e(t,n){var o,r,i,a,s,c,u,f,l,d,h;return j.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this,(o=new U.LASFile(t)).open(),e.next=5,o.getHeader();case 5:return r=e.sent,e.next=8,o.readData(r.pointsCount,r.offset,0);case 8:for(i=e.sent,r.offset,a=i.buffer,s=new U.LASDecoder(a,r.pointsFormatId,r.pointsStructSize,r.pointsCount,r.pointsCount,r.scale,r.offset,r.mins,r.maxs),c=[],u=[],f=0,l=r.pointsCount-1;f<l;f+=4)d=s.getPoint(f),c.push(d.position[0]*r.scale[0]+r.offset[0]-r.mins[0]),c.push(d.position[2]*r.scale[2]+r.offset[2]-r.mins[2]),c.push(d.position[1]*r.scale[1]+r.offset[1]-r.mins[1]),u.push(d.color[0]/65535),u.push(d.color[1]/65535),u.push(d.color[2]/65535);return h={position:c,color:u},e.abrupt("return",h);case 17:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()};var D=function(e){function t(){return Object(c.a)(this,t),Object(f.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){!function(e,t,n){var o=function(e,t){var n=e.createElement("canvas");return n.requestPointerLock(),t.appendChild(n),n}(document,e),r=new L(o);function i(){o.style.width="100%",o.style.height="100%",o.width=window.innerWidth,o.height=window.innerHeight,r.onWindowResize(o)}function a(e){r.onKeyDown(e)}function s(e){r.onKeyUp(e)}!function(e){var n=new M(e);n.load("Block_589.las",function(e,t){e.then(function(e){r.createSceneSubjects(r.scene,e),t()})},function(e){t(e.loaded/e.total*100)},function(e){window.alert(e||"An error happened when downloading the file")},e)}(n),window.onresize=i,window.onkeydown=a,window.onkeyup=s,i(),function e(){requestAnimationFrame(e),r.update()}()}(this.threeRootElement,this.props.changePercentage,this.props.toggleColorsLoaded)}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{style:{backgroundColor:"#f0f0f0"},ref:function(t){e.threeRootElement=t}})}}]),t}(o.Component),I=(n(178),function(e){function t(){var e,n;Object(c.a)(this,t);for(var o=arguments.length,r=new Array(o),i=0;i<o;i++)r[i]=arguments[i];return(n=Object(f.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(r)))).state={colorsLoaded:!1,showTitle:!1,showButton:!0,showProgress:!1,showViewer:!1,percentageLoaded:0},n.handleClick=function(){n.toggleTitle(),n.toggleButton()},n.toggleViewer=function(){n.toggleProgress(),n.setState({showViewer:!n.state.showViewer})},n.toggleTitle=function(){n.setState({showTitle:!n.state.showTitle})},n.toggleButton=function(){n.setState({showButton:!n.state.showButton})},n.toggleProgress=function(){n.setState({showProgress:!n.state.showProgress})},n.changePercentage=function(e){n.setState({percentageLoaded:Math.round(e)})},n.toggleColorsLoaded=function(){n.setState({colorsLoaded:!0}),n.toggleProgress()},n}return Object(d.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){this.setState({showButton:!1,showTitle:!0})}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"App"},r.a.createElement(k,null,r.a.createElement(h.CSSTransition,{in:this.state.showTitle,classNames:"title",timeout:1200,onEntered:function(){return e.setState({showButton:!0})},unmountOnExit:!0},r.a.createElement(x,null,"Welcome to LiDAR-viewer")),r.a.createElement(h.CSSTransition,{in:this.state.showButton,classNames:"continue-button",timeout:1200,onExited:this.toggleViewer,unmountOnExit:!0},r.a.createElement(s.a,{type:"primary",onClick:this.handleClick},"Continue"))),this.state.showViewer&&r.a.createElement(D,{changePercentage:this.changePercentage,toggleColorsLoaded:this.toggleColorsLoaded}),r.a.createElement(h.CSSTransition,{in:this.state.showProgress,classNames:"progress",timeout:1e3,unmountOnExit:!0},r.a.createElement(b,{fileRead:100===this.state.percentageLoaded,colorsLoaded:this.state.colorsLoaded})))}}]),t}(o.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a.a.render(r.a.createElement(I,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},62:function(e,t){e.exports={style:{"@primary-color":"#1d9ea5",fonts:{primary:"SansForgetica-Regular"}}}},64:function(e,t){!function(e){var t={0:function(e){return{position:[e.getInt32(0,!0),e.getInt32(4,!0),e.getInt32(8,!0)],intensity:e.getUint16(12,!0),classification:e.getUint8(16,!0)}},1:function(e){return{position:[e.getInt32(0,!0),e.getInt32(4,!0),e.getInt32(8,!0)],intensity:e.getUint16(12,!0),classification:e.getUint8(16,!0)}},2:function(e){return{position:[e.getInt32(0,!0),e.getInt32(4,!0),e.getInt32(8,!0)],intensity:e.getUint16(12,!0),classification:e.getUint8(16,!0),color:[e.getUint16(20,!0),e.getUint16(22,!0),e.getUint16(24,!0)]}},3:function(e){return{position:[e.getInt32(0,!0),e.getInt32(4,!0),e.getInt32(8,!0)],intensity:e.getUint16(12,!0),classification:e.getUint8(16,!0),color:[e.getUint16(28,!0),e.getUint16(30,!0),e.getUint16(32,!0)]}}};function n(e,t,n,o){o=void 0===o||0===o?1:o;var r=new t(e.slice(n,n+t.BYTES_PER_ELEMENT*o));if(void 0===o||1===o)return r[0];for(var i=[],a=0;a<o;a++)i.push(r[a]);return i}var o={};e.handleMessage=function(e){var t=e.data,n=o[t.id];delete o[t.id],setTimeout(function(){return t.error?n.reject(new Error(t.message||"Unknown Error")):t.hasOwnProperty("count")&&t.hasOwnProperty("hasMoreData")?n.resolve({buffer:t.result,count:t.count,hasMoreData:t.hasMoreData}):void n.resolve(t.result)},0)};var r=function(e){this.arraybuffer=e};r.prototype.open=function(){return this.readOffset=0,new Promise(function(e,t){setTimeout(e,0)})},r.prototype.getHeader=function(){var e=this;return new Promise(function(t,o){setTimeout(function(){e.header=function(e){var t={};t.pointsOffset=n(e,Uint32Array,96),t.pointsFormatId=n(e,Uint8Array,104),t.pointsStructSize=n(e,Uint16Array,105),t.pointsCount=n(e,Uint32Array,107);var o=131;t.scale=n(e,Float64Array,o,3),o+=24,t.offset=n(e,Float64Array,o,3),o+=24;var r=n(e,Float64Array,o,6);return o+=48,t.maxs=[r[0],r[2],r[4]],t.mins=[r[1],r[3],r[5]],t}(e.arraybuffer),t(e.header)},0)})},r.prototype.readData=function(e,t,n){var o=this;return new Promise(function(t,r){setTimeout(function(){if(!o.header)return r(new Error("Cannot start reading data till a header request is issued"));var i;if(n<=1){e=Math.min(e,o.header.pointsCount-o.readOffset);var a=(i=o.header.pointsOffset+o.readOffset*o.header.pointsStructSize)+e*o.header.pointsStructSize;t({buffer:o.arraybuffer.slice(i,a),count:e,hasMoreData:o.readOffset+e<o.header.pointsCount}),o.readOffset+=e}else{for(var s=Math.min(e*n,o.header.pointsCount-o.readOffset),c=Math.ceil(s/n),u=0,f=new Uint8Array(c*o.header.pointsStructSize),l=0;l<s;l++){if(l%n===0){i=o.header.pointsOffset+o.readOffset*o.header.pointsStructSize;var d=new Uint8Array(o.arraybuffer,i,o.header.pointsStructSize);f.set(d,u*o.header.pointsStructSize),u++}o.readOffset++}t({buffer:f.buffer,count:u,hasMoreData:o.readOffset<o.header.pointsCount})}},0)})},r.prototype.close=function(){var e=this;return new Promise(function(t,n){e.arraybuffer=null,setTimeout(t,0)})};var i=function(e){if(this.arraybuffer=e,this.determineVersion(),this.version>12)throw new Error("Only file versions <= 1.2 are supported at this time");if(this.determineFormat(),void 0===t[this.formatId])throw new Error("The point format ID is not supported");this.loader=new r(this.arraybuffer)};i.prototype.determineFormat=function(){var e=n(this.arraybuffer,Uint8Array,104),t=(128&e)>>7,o=(64&e)>>6;if(1===t&&1===o)throw new Error("Old style compression not supported");this.formatId=63&e,this.isCompressed=1===t||1===o},i.prototype.determineVersion=function(){var e=new Int8Array(this.arraybuffer,24,2);this.version=10*e[0]+e[1],this.versionAsString=e[0]+"."+e[1]},i.prototype.open=function(){return this.loader.open()},i.prototype.getHeader=function(){return this.loader.getHeader()},i.prototype.readData=function(e,t,n){return this.loader.readData(e,t,n)},i.prototype.close=function(){return this.loader.close()};var a=function(e,n,o,r,i,a,s,c){this.arrayb=e,this.decoder=t[n],this.pointsCount=r,this.pointSize=o,this.scale=i,this.offset=a,this.mins=s,this.maxs=c};a.prototype.getPoint=function(e){if(e<0||e>=this.pointsCount)throw new Error("Point index out of range");var t=new DataView(this.arrayb,e*this.pointSize,this.pointSize);return this.decoder(t)},e.LASLoader=r,e.LASFile=i,e.LASDecoder=a,e.LASModuleWasLoaded=!1}(e.exports)},95:function(e,t,n){e.exports=n(181)}},[[95,2,1]]]);
//# sourceMappingURL=main.2ce19800.chunk.js.map